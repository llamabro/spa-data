// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.15/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"url:jimu/dijit/_filter/ListMultipleSelect.html":'\x3cdiv class\x3d"jimu-list-multiple-select" data-dojo-attach-point\x3d"multipleSelect" \x3e\r\n  \x3cdiv class\x3d"selectedContainer" data-dojo-attach-point\x3d"selectedContainer"\x3e\r\n    \x3cdiv class\x3d"jimu-multiple-items-list" data-dojo-attach-point\x3d"selectedListContent"\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv\x3e\r\n    \x3c!-- \x3cdiv style\x3d"position:absolute;height:345px;width:100%;z-index:1;display:none;" data-dojo-attach-point\x3d"listContainerOverlay"\x3e\x3c/div\x3e --\x3e\r\n    \x3cdiv class\x3d"searchKeyInput" data-dojo-attach-point\x3d"searchKeyInput" style\x3d"display:none;"\x3e\r\n      \x3cinput value\x3d"" placeholder\x3d"${jimuCommonNls.search}" data-dojo-type\x3d"dijit/form/ValidationTextBox"\r\n       data-dojo-attach-point\x3d"valueInput" data-dojo-props\x3d\'"required":false,intermediateChanges:true\' style\x3d"width:100%;" /\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"items-content loading-center" data-dojo-attach-point\x3d"listContainer"\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"listContentStore"style\x3d"height:1px;visibility:hidden;overflow:hidden;"\x3e\r\n      \x3c/div\x3e --\x3e\r\n      \x3cdiv class\x3d"jimu-multiple-items-list" data-dojo-attach-point\x3d"listContent"\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"loadMoreDataBtn" class\x3d"jimu-list-multiple-select-Tips load-more-data-Tips"\x3e${jimuCommonNls.searchMore}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${Nls.noData}\x3c/div\x3e --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"noDataTips" class\x3d"jimu-list-multiple-select-Tips no-data-Tips"\x3e${noDataNls}\x3c/div\x3e\r\n      \x3c!-- \x3cdiv class\x3d"createNewItem" data-dojo-attach-point\x3d"createNewItem" data-dojo-attach-event\x3d"click:_createTarget"\x3e\x26nbsp;\x3c/div\x3e --\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n  \x3cdiv class\x3d"selectedToggleDiv" style\x3d"display:none;" data-dojo-attach-point\x3d"selectedToggleDiv"\x3e\r\n    \x3cspan class\x3d"selectedToggle" data-dojo-attach-point\x3d"selectedToggle"\x3e\x3c/span\x3e\r\n    \x3cspan class\x3d"toggleTxt" title\x3d"${Nls.showSelected}"\x3e${Nls.showSelected}\x3c/span\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e'}});
define("dojo/_base/lang dojo/Evented dojo/_base/html dojo/_base/declare dijit/_WidgetBase dojo/on dojo/query dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListMultipleSelect.html jimu/dijit/ToggleButton jimu/utils".split(" "),function(g,n,c,p,q,h,k,r,t,u,v,w){return p([q,r,t,n],{templateString:u,selectType:null,dataList:[],checkedList:[],checkedLabelList:[],_itemLabelW:215,ifFristPage:!0,queryState:!0,isCacheFinish:!1,keyQueryMode:!1,cacheQueryMode:!1,emptyStr:"",postMixInProperties:function(){this.inherited(arguments);
this.jimuCommonNls=window.jimuNls.common;this.Nls=window.jimuNls.filterBuilder;this.noDataNls=window.apiNls.widgets.FeatureTable.noData},postCreate:function(){this.inherited(arguments);this.inputType="unique"===this.selectType?"radio":"checkbox";if("multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType)c.addClass(this.listContainer,"items-setting-dropdown-content"),this.searchKeyInput.style.display="block";"uniqueDynamic"===this.controlType&&c.addClass(this.listContainer,"items_content_no_selected_toggle");
this.runtime?(c.addClass(this.listContainer,"items-widget-content"),"dropdown"!==this.selectUI&&(c.addClass(this.listContainer,"items-widget-expaned-content"),c.addClass(this.listContent,"jimu-multiple-items-expanded-list"))):(c.addClass(this.listContainer,"items-setting-popup-content"),this.searchKeyInput.style.display="block");this.runtime||"predefined"!==this.controlType||(c.addClass(this.listContainer,"items-setting-dropdown-content"),this.searchKeyInput.style.display="block");this._addCBXClickEvent();
("dropdown"===this.selectUI||"predefined"===this.controlType&&!this.runtime)&&this._addCBXHoverEvent();this.disPlayLabel="value";!this.runtime||"multiplePredefined"!==this.controlType&&"uniquePredefined"!==this.controlType||(this.disPlayLabel="alias");if("multipleDynamic"===this.controlType){this.selectedToggleDiv.style.display="block";var a=new v({},this.selectedToggle);a.startup();this.selectedToggle.toggleButton=a;this.own(h(this.selectedToggleDiv,"click",g.hitch(this,"_toggleFilter")));this._addSelectedContainerEvent()}},
_toggleFilter:function(a){var b=this.selectedToggle;c.hasClass(b,"applied")?(c.removeClass(b,"applied"),b.toggleButton.uncheck(),this.selectedContainer.style.display="none"):(c.addClass(b,"applied"),b.toggleButton.check(),this._initSelectedContainerItems(),this.selectedContainer.style.display="block");a.stopPropagation()},_initSelectedContainerItems:function(){for(var a=this.selectedListContent.innerHTML="",b=this.runtime?" labelRuntime":"",d=0;d<this.checkedList.length;d++)var c=this.checkedList[d],
a=a+('\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+' checked" '+(this.isNumberField?"data\x3d"+c:"data\x3d'"+c+"'")+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label jimu-ellipsis'+b+'" title\x3d"'+c+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+("value"===this.disPlayLabel?c:this.checkedLabelList[d])+"\x3c/div\x3e\x3c/div\x3e");this.selectedListContent.innerHTML=a},_addSelectedContainerEvent:function(){this.own(h(this.selectedListContent,"click",g.hitch(this,function(a){var b=
a.target,d;if(c.hasClass(b,"item"))d=b.firstElementChild,b=b.firstElementChild.nextSibling;else if(c.hasClass(b,"checkInput"))d=b,b=b.nextSibling;else if(c.hasClass(b,"label"))d=b.previousSibling;else{a.stopPropagation();return}var e=b=b.innerText;if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)e=c.getAttr(d,"data");if(c.hasClass(d,"checked")){if("radio"===this.inputType)return;c.removeClass(d,"checked");this._updateCheckedList("remove",e,b);this.checkCBXItems();this.emit("listMultipleSelect_itemUnChecked",
b)}else"radio"===this.inputType&&this.currentItem&&(!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),c.removeClass(this.currentItem,"checked")),c.addClass(d,"checked"),this._updateCheckedList("add",e,b),this.checkCBXItems(),this.emit("listMultipleSelect_itemChecked",b);a.stopPropagation()})))},_updateCheckedList:function(a,b,d){b!==this.emptyStr&&(b=this.isNumberField?parseFloat(b):b);if("remove"===a)for(var c in this.checkedList)this.checkedList[c]===b&&(this.checkedList.splice(c,
1),this.checkedLabelList.splice(c,1));else"radio"===this.inputType?(this.checkedList=[b],this.checkedLabelList=[d]):0>this.checkedList.indexOf(b)&&(this.checkedList.push(b),this.checkedLabelList.push(d))},_updateCheckedLabelList:function(a){this.checkedLabelList=[];for(var b=0;b<this.checkedList.length;b++)for(var d=0;d<a.length;d++)this.checkedList[b]===a[d].value&&this.checkedLabelList.push(a[d].label)},_createTarget:function(a){a=a.target.innerText.split(": ")[1];this.emit("listMultipleSelect_itemChecked",
a)},_deleteCBXItem:function(){},_getCheckInputItems:function(){return k(".item .checkInput",this.listContent)},getListCheckedValuesOrigin:function(){for(var a=[],b=this._getCheckInputItems(),d=0;d<b.length;d++){var e=b[d],f=e.nextSibling.innerText;c.hasClass(e,"checked")&&a.push(f)}return a},getListCheckedValues:function(){for(var a=[],b=g.clone(this.checkedList),d=0;d<b.length;d++){var c=b[d],c=this.isNumberField?parseFloat(c):c;a.push(c)}return a},getListValues:function(){var a=[],b=this._getCheckInputItems();
if(0===b.length)return this.dataList;for(var d=0;d<b.length;d++){var e=b[d],f=e.nextSibling.innerText;if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)f=c.getAttr(e,"data");f=this.isNumberField?parseFloat(f):f;f={value:f,isChecked:!1};c.hasClass(e,"checked")&&(f.isChecked=!0);a.push(f)}return a},getIfValueExist:function(a){for(var b=this._getCheckInputItems(),c=0;c<b.length;c++)if(a===b[c].nextSibling.innerText)return!0;return!1},getCurrentItem:function(){for(var a=this._getCheckInputItems(),
b=0;b<a.length;b++){var d=a[b];if(c.hasClass(d,"checked"))return d}return null},checkCBXItems:function(a){a=a?"":this.valueInput.get("value");this.valueInput.set("value",a);a=k(".item .label",this.listContent);for(var b=0;b<a.length;b++){var d=a[b],e="value"===this.disPlayLabel?d.innerText:c.getAttr(d.previousSibling,"data"),e=this.isNumberField?parseFloat(e):e;0<=this.checkedList.indexOf(e)?c.addClass(d.previousSibling,"checked"):c.removeClass(d.previousSibling,"checked")}},reset:function(){this.listContent.innerHTML=
""},setCBXData:function(a,b,d,e){e||(this.queryState=!1);a=a?a:[];c.setStyle(this.noDataTips,"display","none");var f=0,g="radio"===this.inputType?" labelBig":"",h=this.runtime?" labelRuntime":"";e=this.listContent.innerHTML;d&&(e=this.listContent.innerHTML="","uniqueDynamic"!==this.controlType||this.keyQueryMode||(e="",this.checkedList[0]===this.emptyStr&&(e=" checked",f=1),e='\x3cdiv class\x3d"item emptyItem active"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+e+'" '+("data\x3d'"+this.emptyStr+
"'")+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label'+g+" jimu-ellipsis"+h+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+this.emptyStr+"\x3c/div\x3e\x3c/div\x3e"),this.listContainer.scrollTop=0);if(0===a.length)return a=this.listContent.innerHTML.replace(/(^\s*)|(\s*$)/g,""),""!==a||this.cacheQueryMode&&!this.isCacheFinish||c.setStyle(this.noDataTips,"display","block"),""===a&&(this.listContent.innerHTML=e),this.listContent;d="";for(var m=0;m<a.length;m++){var l=a[m],k="";b&&0<=this.checkedList.indexOf(l.value)&&
(k=" checked",this.currentItem=!0,f++);d+='\x3cdiv class\x3d"item"\x3e\x3cdiv class\x3d"checkInput '+this.inputType+k+'" '+(this.isNumberField?"data\x3d"+l.value:"data\x3d'"+l.value+"'")+'\x3e\x3c/div\x3e\x3cdiv class\x3d"label'+g+" jimu-ellipsis"+h+'" title\x3d"'+l.value+'" style\x3d"max-width:'+this._itemLabelW+'px"\x3e'+l[this.disPlayLabel]+"\x3c/div\x3e\x3c/div\x3e"}a=this.checkedList.length-f;if(this.runtime&&0<a)for(b=0;b<a;b++)this.emit("listMultipleSelect_itemUnChecked","");this.listContent.innerHTML=
e+d;return this.listContent},setCBXContentBySearch:function(a,b){0===a.length?this.setCBXData([],!1,!0,b):this.setCBXData(a,!0,!0,b)},_onSearchKeyChange:function(){var a=this.valueInput.get("value");this.searchName=a;this.listContainer.scrollTop=0;this.reset();this.cacheQueryMode=this.keyQueryMode=this.ifFristPage=!0;this.emit("listMultipleSelect_searchKeyLocal",a);this.codedValues||(this.isCacheFinish||c.setStyle(this.loadMoreDataBtn,"display","block"),0===a.length&&(this.queryState=this.cacheQueryMode=
this.keyQueryMode=!1,c.setStyle(this.loadMoreDataBtn,"display","none")))},_loadMoreDataFromServer:function(){this.keyQueryMode=this.ifFristPage=!0;this.cacheQueryMode=!1;this.queryState=!0;c.setStyle(this.loadMoreDataBtn,"display","none");var a=this.valueInput.get("value");this.searchName=a;this.listContainer.scrollTop=0;"multipleDynamic"===this.controlType||"uniqueDynamic"===this.controlType?this.emit("listMultipleSelect_searchKey",a):this.runtime||this.emit("listMultipleSelect_searchKey",a)},currentHoverItem:null,
_addCBXHoverEvent:function(){this.own(h(this.listContent,"mouseover",g.hitch(this,function(a){a=a.target||a.srcElement;a=c.hasClass(a,"item")?a:w.getAncestorDom(a,function(a){return c.hasClass(a,"item")},3);this.currentHoverItem&&c.removeClass(this.currentHoverItem,"active");c.addClass(a,"active");this.currentHoverItem=a})));this.own(h(this.listContent,"mouseout",g.hitch(this,function(){this.currentHoverItem&&c.removeClass(this.currentHoverItem,"active");this.currentHoverItem=null})))},_addCBXClickEvent:function(){this.own(h(this.valueInput,
"change",g.hitch(this,function(){this._onSearchKeyChange()})));this.own(h(this.loadMoreDataBtn,"click",g.hitch(this,function(){this._loadMoreDataFromServer()})));this.own(h(this.listContainer,"scroll",g.hitch(this,this.dropDownScroll)));this.own(h(this.searchKeyInput,"click",g.hitch(this,function(a){a.stopPropagation()})));this.own(h(this.listContainer,"click",g.hitch(this,function(a){var b=a.target,d;if(c.hasClass(b,"item"))d=b.firstElementChild,b=b.firstElementChild.nextSibling;else if(c.hasClass(b,
"checkInput"))d=b,b=b.nextSibling;else if(c.hasClass(b,"label"))d=b.previousSibling;else{a.stopPropagation();return}this._setCBXChecked(d,b.innerText);a.stopPropagation()})))},scrollDiff:100,dropDownScroll:function(a){this.runtime&&("uniquePredefined"===this.controlType||"multiplePredefined"===this.controlType)||this.cacheQueryMode||this.codedValues||(this.queryState?this.listContainer.scrollTop=this.containerScrollTop:(a=a.target,a.scrollHeight-a.clientHeight-a.scrollTop<=this.scrollDiff&&!this.queryState&&
(this.containerScrollTop=this.listContainer.scrollTop,this.queryState=!0,this.ifFristPage=!1,this.emit("listMultipleSelect_addNextPage"))))},_setCBXChecked:function(a,b){var d=b;if("alias"===this.disPlayLabel||"label"===this.disPlayLabel)d=c.getAttr(a,"data");c.hasClass(a,"checked")?"radio"===this.inputType?this.runtime||"predefined"!==this.controlType?this.emit("listMultipleSelect_itemChecked",b):this.emit("listMultipleSelect_itemCheckedForPredefined",b):(c.removeClass(a,"checked"),this._updateCheckedList("remove",
d,b),this.emit("listMultipleSelect_itemUnChecked",b)):("radio"===this.inputType&&this.currentItem&&(!0===this.currentItem&&(this.currentItem=this.getCurrentItem()),this.currentItem&&c.removeClass(this.currentItem,"checked")),c.addClass(a,"checked"),this.currentItem=a,this._updateCheckedList("add",d,b),this.runtime||"predefined"!==this.controlType?this.emit("listMultipleSelect_itemChecked",b):this.emit("listMultipleSelect_itemCheckedForPredefined",b))},initDoms:function(a,b){this.setCBXData(a,b)},
getData:function(){},refreshData:function(){this.checkCBXItems()},validate:function(){var a=this.checkedList.length?"12345678":null;1===this.checkedList.length&&this.checkedList[0]===this.emptyStr&&(a=null);this.set("DisplayedValue",a);return!0},setRequired:function(a){this.mutiValuesSelect.set("required",a)},destroy:function(){c.destroy(this.domNode);this.inherited(arguments)}})});